fname)
write_csv(dat,
path = new_fname)
new_samp_fname = gsub("[.]csv",
"_residences_with_Taxes_cleaned_sample.csv",
fname)
write_csv(dat[sample(nrow(dat), size = 1e4),],
path = new_samp_fname)
getOption("viewer")
getOption("viewer")
library(rstudioapi)
?viewer
library(readr)
read_sav
library(haven)
help(package = "haven")
?file.path
require(devtools)
x = require(devtools)
x
x = require(asdfsdf)
x
?download.file
demo(package = "rvest")
demo("zillow", package = "rvest")
vignette("selectorgadget"))
vignette("selectorgadget")
library(extrantsr)
library(ANTsR)
setwd("~/Downloads/CHB_test1_Part1/")
nhdrs = list.files(path = getwd(), pattern = "[.]nhdr$")
library(extrantsr)
library(ANTsR)
setwd("~/Downloads/CHB_test1_Part1/")
nhdrs = list.files(path = getwd(), pattern = "[.]nhdr$")
nhdrs
library(extrantsr)
library(ANTsR)
setwd("~/Downloads/CHB_test1_Part1/")
nhdrs = list.files(path = getwd(),
pattern = "[.]nhdr$", recursive = TRUE)
nhdrs
library(extrantsr)
library(ANTsR)
datadir = "~/Downloads/CHB_test1_Part1"
nhdrs = list.files(path = datadir,
pattern = "[.]nhdr$", recursive = TRUE)
library(extrantsr)
library(ANTsR)
datadir = "~/Downloads/CHB_test1_Part1"
nhdrs = list.files(path = datadir,
pattern = "[.]nhdr$",
recursive = TRUE, full.names = TRUE)
df = data.frame(nhdr = nhdrs, nii = gsub("[.]nhdr$", ".nii.gz", nhdrs),
stringsAsFactors = FALSE)
df
library(extrantsr)
library(ANTsR)
datadir = "~/Downloads/CHB_test1_Part1"
nhdrs = list.files(path = datadir,
pattern = "[.]nhdr$",
recursive = TRUE, full.names = TRUE)
df = data.frame(nhdr = nhdrs, nii = gsub("[.]nhdr$", ".nii.gz", nhdrs),
stringsAsFactors = FALSE)
df = df[ !file.exists(df$nii),]
df
library(extrantsr)
library(ANTsR)
library(plyr)
datadir = "~/Downloads/CHB_test1_Part1"
nhdrs = list.files(path = datadir,
pattern = "[.]nhdr$",
recursive = TRUE, full.names = TRUE)
df = data.frame(nhdr = nhdrs, nii = gsub("[.]nhdr$", ".nii.gz", nhdrs),
stringsAsFactors = FALSE)
df = df[ !file.exists(df$nii),]
m_ply
?m_ply
library(extrantsr)
library(ANTsR)
library(plyr)
datadir = "~/Downloads/CHB_test1_Part1"
nhdrs = list.files(path = datadir,
pattern = "[.]nhdr$",
recursive = TRUE, full.names = TRUE)
df = data.frame(nhdr = nhdrs, nii = gsub("[.]nhdr$", ".nii.gz", nhdrs),
stringsAsFactors = FALSE)
df = df[ !file.exists(df$nii),]
m_ply(df, function(nhdr, nii){
c3d(infile = nhdr, outfile = nii)
}, .progress = "text")
library(extrantsr)
library(ANTsR)
library(plyr)
datadir = "~/Downloads/CHB_test1_Part1"
nhdrs = list.files(path = datadir,
pattern = "[.]nhdr$",
recursive = TRUE, full.names = TRUE)
df = data.frame(nhdr = nhdrs, nii = gsub("[.]nhdr$", ".nii.gz", nhdrs),
stringsAsFactors = FALSE)
df = df[ !file.exists(df$nii),]
m_ply(df, function(nhdr, nii){
c3d(infile = nhdr, outfile = nii)
}, .progress = "text")
good_df = df[ file.exists(df$nii),]
df = df[ !file.exists(df$nii),]
file.remove(good_df$nhdr)
good_df
file.exists(df$nii)
library(extrantsr)
library(ANTsR)
library(plyr)
datadir = "~/Downloads/CHB_test1_Part1"
nhdrs = list.files(path = datadir,
pattern = "[.]nhdr$",
recursive = TRUE, full.names = TRUE)
df = data.frame(nhdr = nhdrs, nii = gsub("[.]nhdr$", ".nii.gz", nhdrs),
stringsAsFactors = FALSE)
run_df = df[ !file.exists(df$nii),]
run_df
df
m_ply(run_df, function(nhdr, nii){
c3d(infile = nhdr, outfile = nii)
}, .progress = "text")
good_df = df[ file.exists(df$nii),]
good_df
good_df = df[ file.exists(df$nii),]
library(extrantsr)
library(ANTsR)
library(plyr)
datadir = "~/Downloads/CHB_test1_Part1"
nhdrs = list.files(path = datadir,
pattern = "[.]nhdr$",
recursive = TRUE, full.names = TRUE)
df = data.frame(nhdr = nhdrs, nii = gsub("[.]nhdr$", ".nii.gz", nhdrs),
stringsAsFactors = FALSE)
run_df = df[ !file.exists(df$nii),]
m_ply(run_df, function(nhdr, nii){
c3d(infile = nhdr, outfile = nii)
}, .progress = "text")
good_df = df[ file.exists(df$nii),]
file.remove(good_df$nhdr)
library(extrantsr)
library(ANTsR)
library(plyr)
datadir = "~/Downloads/CHB_test1_Part1"
nhdrs = list.files(path = datadir,
pattern = "[.]nhdr$",
recursive = TRUE, full.names = TRUE)
df = data.frame(nhdr = nhdrs, nii = gsub("[.]nhdr$", ".nii.gz", nhdrs),
stringsAsFactors = FALSE)
run_df = df[ !file.exists(df$nii),]
m_ply(run_df, function(nhdr, nii){
c3d(infile = nhdr, outfile = nii)
}, .progress = "text")
good_df = df[ file.exists(df$nii),]
file.remove(good_df$nhdr)
file.remove(gsub("[.]nhdr$", ".raw", good_df$nhdr))
library(extrantsr)
library(ANTsR)
library(plyr)
datadir = "~/Downloads/CHB_test1_Part1"
nhdrs = list.files(path = datadir,
pattern = "[.](nhdr|raw)$",
recursive = TRUE, full.names = TRUE)
nhdrs
library(extrantsr)
library(ANTsR)
library(plyr)
datadir = "~/Downloads/CHB_test1_Part1"
nhdrs = list.files(path = datadir,
pattern = "[.](nhdr|raw)$",
recursive = TRUE, full.names = TRUE)
df = data.frame(nhdr = nhdrs, nii = gsub("[.]nhdr$", ".nii.gz", nhdrs),
stringsAsFactors = FALSE)
df
library(extrantsr)
library(ANTsR)
library(plyr)
datadir = "~/Downloads/CHB_test1_Part1"
nhdrs = list.files(path = datadir,
pattern = "[.]nhdr$",
recursive = TRUE, full.names = TRUE)
nii = gsub("[.]nhdr$", ".nii.gz", nhdrs)
nii = gsub("[.]raw$", ".nii.gz", nii)
df = data.frame(nhdr = nhdrs, nii = nii,
stringsAsFactors = FALSE)
run_df = df[ !file.exists(df$nii),]
run_df
m_ply(run_df, function(nhdr, nii){
c3d(infile = nhdr, outfile = nii)
}, .progress = "text")
good_df = df[ file.exists(df$nii),]
file.remove(good_df$nhdr)
good_df
library(extrantsr)
library(ANTsR)
library(plyr)
datadir = "~/Downloads/CHB_test1_Part1"
nhdrs = list.files(path = datadir,
pattern = "[.]nhdr$",
recursive = TRUE, full.names = TRUE)
nii = gsub("[.]nhdr$", ".nii.gz", nhdrs)
nii = gsub("[.]raw$", ".nii.gz", nii)
df = data.frame(nhdr = nhdrs, nii = nii,
stringsAsFactors = FALSE)
df
library(extrantsr)
library(ANTsR)
library(plyr)
datadir = "~/Downloads/CHB_test1_Part1"
nhdrs = list.files(path = datadir,
pattern = "[.]nhdr$",
recursive = TRUE, full.names = TRUE)
nii = gsub("[.]nhdr$", ".nii.gz", nhdrs)
nii
library(extrantsr)
library(ANTsR)
library(plyr)
datadir = "~/Downloads/CHB_test1_Part1"
nhdrs = list.files(path = datadir,
pattern = "[.](nhdr|raw)$",
recursive = TRUE, full.names = TRUE)
nii = gsub("[.]nhdr$", ".nii.gz", nhdrs)
nii = gsub("[.]raw$", ".nii.gz", nii)
df = data.frame(nhdr = nhdrs, nii = nii,
stringsAsFactors = FALSE)
df
run_df = df[ !file.exists(df$nii),]
run_df
m_ply(run_df, function(nhdr, nii){
c3d(infile = nhdr, outfile = nii)
}, .progress = "text")
good_df = df[ file.exists(df$nii),]
good_df
library(extrantsr)
library(ANTsR)
library(plyr)
datadir = "~/Downloads/CHB_test1_Part1"
nhdrs = list.files(path = datadir,
pattern = "[.](nhdr|raw)$",
recursive = TRUE, full.names = TRUE)
nii = gsub("[.]nhdr$", ".nii.gz", nhdrs)
nii = gsub("[.]raw$", ".nii.gz", nii)
df = data.frame(nhdr = nhdrs, nii = nii,
stringsAsFactors = FALSE)
run_df = df[ !file.exists(df$nii) & grepl("[.]nhdr$", df$nhdr),]
run_df
m_ply(run_df, function(nhdr, nii){
c3d(infile = nhdr, outfile = nii)
}, .progress = "text")
good_df = df[ file.exists(df$nii),]
good_df
file.remove(good_df$nhdr)
df = df[ !file.exists(df$nii),]
stopifnot(nrow(df) == 0)
library(rdom)
install.packages('rdom')
devtools::install_github("cpsievert/rdom")
devtools::install_github("cpsievert/rdom")
library(rdom)
years = 10:13
urls = paste0("http://factfinder.census.gov/faces/tableservices/jsf/pages/productview.xhtml?pid=ACS_",
years, "_5YR_DP03&src=pt")
rdom(urls[1])
devtools::install_github("cpsievert/rdom")
library(rdom)
years = 10:13
urls = paste0("http://factfinder.census.gov/faces/tableservices/jsf/pages/productview.xhtml?pid=ACS_",
years, "_5YR_DP03&src=pt")
rdom(urls[1])
rdom("http://bl.ocks.org/cpsievert/raw/2a9fb8f504cd56e9e8e3/")
# devtools::install_github("cpsievert/rdom")
library(rdom)
years = 10:13
urls = paste0("http://factfinder.census.gov/faces/tableservices/jsf/pages/productview.xhtml?pid=ACS_",
years, "_5YR_DP03&src=pt")
rdom(urls[1])
# devtools::install_github("cpsievert/rdom")
library(rdom)
years = 10:13
urls = paste0("http://factfinder.census.gov/faces/tableservices/jsf/pages/productview.xhtml?pid=ACS_",
years, "_5YR_DP03&src=pt")
rdom(urls[1]) %>%
html_node("table") %>% html_table()
source('~/.active-rstudio-document')
library(rvest)
tab = rdom(urls[1]) %>%
html_node("table") %>% html_table()
page = rdom(urls[1])
html_nodes(page, ".field")
table = page %>%
html_node("table") %>% html_table(fill = TRUE)
table
head(table)
library(rvest)
url = "http://www.theguardian.com/news/datablog/2012/jul/22/gun-homicides-ownership-world-list"
page = html(url)
class(page)
tab = html_table(page)
class(tab)
length(tab)
tab = tab[[1]]
head(tab)
tab[3, "Number of homicides by firearm"]
sum(is.na(tab[, "Number of homicides by firearm"]))
for (icol in colnames(tab)){
tab[ tab[, icol] %in% "", icol] = NA
}
sum(is.na(tab[, "Number of homicides by firearm"]))
html_nodes(page, xpath = "//tr[@class='left']")
html_nodes(page, xpath = "//td[@class='left']")
left_nodes = html_nodes(page, xpath = "//td[@class='left']")
left_nodes[1:3]
left_nodes = html_nodes(page, xpath = "//td")
html_text(left_nodes[[1]])
html_text(left_nodes[[2]])
class(left_nods)
class(left_nodes)
texts = lapply(left_nodes, html_text)
texts
sapply(texts, length)
table(sapply(texts, length))
head(texts)
texts = unlist(texts)
texts
dat = matrix(texts, ncol = 7, byrow=TRUE)
tail(texts)
# Jisoo Example
library(rvest)
url = "http://www.theguardian.com/news/datablog/2012/jul/22/gun-homicides-ownership-world-list"
page = html(url)
tab = html_table(page)
tail(tab)
class(tab)
tab = tab[[1]]
tail(tab)
left_nodes = html_nodes(page, xpath = "//td")
texts = lapply(left_nodes, html_text)
texts = unlist(texts)
# dropping source
texts = texts[ -length(texts)]
dat = matrix(texts, ncol = 7, byrow=TRUE)
head(dat)
df = data.frame(dat, stringsAsFactors = FALSE)
head(df)
hdrs = html_nodes(page, xpath = "//th")
hdrs = html_nodes(page, xpath = "//th")
hdrs = html_nodes(page, xpath = "//th")
hdrs = lapply(hdrs, html_text)
head(hdrs)
hdrs = html_nodes(page, xpath = "//th")
hdrs = lapply(hdrs, html_text)
hdrs = unlist(hdrs)
hdrs
left_nodes = html_nodes(page, xpath = "//td")
texts = lapply(left_nodes, html_text)
texts = unlist(texts)
# dropping source
texts = texts[ -length(texts)]
hdrs = html_nodes(page, xpath = "//th")
hdrs = lapply(hdrs, html_text)
hdrs = unlist(hdrs)
dat = matrix(texts, ncol = length(hdrs), byrow=TRUE)
df = data.frame(dat, stringsAsFactors = FALSE)
colnames(df) = hdrs
head(df)
head(tab[, "% of homicides by firearm"])
head(df[, "% of homicides by firearm"])
left_nodes = html_nodes(page, xpath = "//td")
texts = lapply(left_nodes, html_text)
texts = unlist(texts)
# dropping source
texts = texts[ -length(texts)]
texts = trimws(texts)
hdrs = html_nodes(page, xpath = "//th")
hdrs = lapply(hdrs, html_text)
hdrs = unlist(hdrs)
dat = matrix(texts, ncol = length(hdrs), byrow=TRUE)
df = data.frame(dat, stringsAsFactors = FALSE)
colnames(df) = hdrs
head(df[, "% of homicides by firearm"])
?`%in
?`%in%`
help("%in%")
tab[, icol] %in% c("", " ")
tab[, icol] == "" | tab[, icol] == " "
tab[, icol] %in% c("", " ")
tab[, tab[, icol] == "" | tab[, icol] == " ", 1]
tab[ tab[, icol] == "" | tab[, icol] == " ", 1]
tab[ tab[, icol] %in% c("", " "), 1]
?try
x = try( "hey")
x
x = try( "hey" + 4)
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
x
x = try( "hey")
x
x = try( "hey" + 4)
attr(x, "try-error")
inherits(x, "try-error")
x = try( "hey")
print(inherits(x, "try-error"))
x = try( "hey" + 4)
print(inherits(x, "try-error"))
source('~/.active-rstudio-document')
rm(list=ls())
url = "http://injuryprevention.bmj.com/content/12/6/365/T2.expansion.html"
x = html(url)
tab = html_table(x)
head(tab)
tab = html_table(x)[[1]]
head(tab)
tab = tab[-2,]
tab$Year = as.numeric(tab$Year)
which(is.na(tab$Year))
tail(tab)
library(dplyr)
tab = filter(tab, !is.na(Year))
head(tab)
tab$Population = gsub(" ", "", tab$Population)
head(tab)
tab = rename(tab, c("Firearm suicide"=  "firearm"))
library(plyr)
rm(list=ls())
url = "http://injuryprevention.bmj.com/content/12/6/365/T2.expansion.html"
x = html(url)
tab = html_table(x)[[1]]
tab$Year = as.numeric(tab$Year)
library(plyr)
library(dplyr)
tab = filter(tab, !is.na(Year))
# tab = tab[!is.na(tab$Year),]
tab$Population = gsub(" ", "",
tab$Population)
rm(list=ls())
library(rvest)
url = "http://injuryprevention.bmj.com/content/12/6/365/T2.expansion.html"
x = html(url)
tab = html_table(x)[[1]]
tab$Year = as.numeric(tab$Year)
library(plyr)
library(dplyr)
rm(list=ls())
library(rvest)
library(plyr)
library(dplyr)
url = "http://injuryprevention.bmj.com/content/12/6/365/T2.expansion.html"
x = html(url)
rm(list=ls())
library(rvest)
library(plyr)
library(dplyr)
url = "http://injuryprevention.bmj.com/content/12/6/365/T2.expansion.html"
x = html(url)
tab = html_table(x)[[1]]
tab$Year = as.numeric(tab$Year)
tab = filter(tab, !is.na(Year))
# tab = tab[!is.na(tab$Year),]
tab$Population = gsub(" ", "",
tab$Population)
tab = plyr::rename(tab, c("Firearm suicide"=  "firearm"))
head(tab)
tab$firearm = trimws(tab$firearm)
head(tab)
ss = strsplit(tab$firearm, " ")
head(ss)
ss = sapply(ss, function(x) x[1])
head(ss)
ss = as.numeric(ss)
head(ss)
pop = gsub("(.*)\(.*\)", "\\1",
tab$Population)
pop = gsub("(.*)\\(.*\\)", "\\1",
tab$Population)
head(pop)
pop = gsub("(.*)\\(.*\\)", "\\1",
tab$firearm)
head(pop)
pop = gsub("(.*) \\(.*\\)", "\\1",
tab$firearm)
head(pop)
years = 10:13
urls = paste0("http://factfinder.census.gov/faces/tableservices/jsf/pages/productview.xhtml?pid=ACS_",
years, "_5YR_DP03&src=pt")
urls[1]
library(rdom)
library(dplyr) # for the %>% command
library(rvest)
years = 10:13
urls = paste0("http://factfinder.census.gov/faces/tableservices/jsf/pages/productview.xhtml?pid=ACS_",
years, "_5YR_DP03&src=pt")
urls
page = rdom(urls[1])
page
table = page %>%
html_node("table") %>% html_table(fill = TRUE)
head(table)
?transmute
?select
?mutate
?transmute
?transform
10*25*52/24
source('~/.active-rstudio-document', echo=TRUE)
setwd("~/Dropbox/JHSPH_Finances/")
install_github('jimhester/knitrBootstrap')
devtools::install_github('jimhester/knitrBootstrap')
library(knitr)
knit("Finance_FAQ.Rmd")
